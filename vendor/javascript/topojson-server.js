// topojson-server@3.0.0 downloaded from https://ga.jspm.io/npm:topojson-server@3.0.0/dist/topojson-server.js

var e={};(function(n,r){r(e)})(e,(function(e){var bounds=function(e){var n=Infinity,r=Infinity,t=-Infinity,i=-Infinity;function boundGeometry(e){null!=e&&o.hasOwnProperty(e.type)&&o[e.type](e)}var o={GeometryCollection:function(e){e.geometries.forEach(boundGeometry)},Point:function(e){boundPoint(e.coordinates)},MultiPoint:function(e){e.coordinates.forEach(boundPoint)},LineString:function(e){boundLine(e.arcs)},MultiLineString:function(e){e.arcs.forEach(boundLine)},Polygon:function(e){e.arcs.forEach(boundLine)},MultiPolygon:function(e){e.arcs.forEach(boundMultiLine)}};function boundPoint(e){var o=e[0],a=e[1];o<n&&(n=o);o>t&&(t=o);a<r&&(r=a);a>i&&(i=a)}function boundLine(e){e.forEach(boundPoint)}function boundMultiLine(e){e.forEach(boundLine)}for(var a in e)boundGeometry(e[a]);return t>=n&&i>=r?[n,r,t,i]:void 0};var hashset=function(e,n,r,t,i){if(3===arguments.length){t=Array;i=null}var o=new t(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),a=e-1;for(var u=0;u<e;++u)o[u]=i;function add(t){var u=n(t)&a,f=o[u],c=0;while(f!=i){if(r(f,t))return true;if(++c>=e)throw new Error("full hashset");f=o[u=u+1&a]}o[u]=t;return true}function has(t){var u=n(t)&a,f=o[u],c=0;while(f!=i){if(r(f,t))return true;if(++c>=e)break;f=o[u=u+1&a]}return false}function values(){var e=[];for(var n=0,r=o.length;n<r;++n){var t=o[n];t!=i&&e.push(t)}return e}return{add:add,has:has,values:values}};var hashmap=function(e,n,r,t,i,o){if(3===arguments.length){t=o=Array;i=null}var a=new t(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),u=new o(e),f=e-1;for(var c=0;c<e;++c)a[c]=i;function set(t,o){var c=n(t)&f,l=a[c],s=0;while(l!=i){if(r(l,t))return u[c]=o;if(++s>=e)throw new Error("full hashmap");l=a[c=c+1&f]}a[c]=t;u[c]=o;return o}function maybeSet(t,o){var c=n(t)&f,l=a[c],s=0;while(l!=i){if(r(l,t))return u[c];if(++s>=e)throw new Error("full hashmap");l=a[c=c+1&f]}a[c]=t;u[c]=o;return o}function get(t,o){var c=n(t)&f,l=a[c],s=0;while(l!=i){if(r(l,t))return u[c];if(++s>=e)break;l=a[c=c+1&f]}return o}function keys(){var e=[];for(var n=0,r=a.length;n<r;++n){var t=a[n];t!=i&&e.push(t)}return e}return{set:set,maybeSet:maybeSet,get:get,keys:keys}};var equalPoint=function(e,n){return e[0]===n[0]&&e[1]===n[1]};var n=new ArrayBuffer(16);var r=new Float64Array(n);var t=new Uint32Array(n);var hashPoint=function(e){r[0]=e[0];r[1]=e[1];var n=t[0]^t[1];n=n<<5^n>>7^t[2]^t[3];return 2147483647&n};var join=function(e){var n=e.coordinates,r=e.lines,t=e.rings,i=index(),o=new Int32Array(n.length),a=new Int32Array(n.length),u=new Int32Array(n.length),f=new Int8Array(n.length),c=0,l,s,h,g,y;for(l=0,s=n.length;l<s;++l)o[l]=a[l]=u[l]=-1;for(l=0,s=r.length;l<s;++l){var v=r[l],d=v[0],m=v[1];g=i[d];y=i[++d];++c,f[g]=1;while(++d<=m)sequence(l,h=g,g=y,y=i[d]);++c,f[y]=1}for(l=0,s=n.length;l<s;++l)o[l]=-1;for(l=0,s=t.length;l<s;++l){var p=t[l],x=p[0]+1,b=p[1];h=i[b-1];g=i[x-1];y=i[x];sequence(l,h,g,y);while(++x<=b)sequence(l,h=g,g=y,y=i[x])}function sequence(e,n,r,t){if(o[r]!==e){o[r]=e;var i=a[r];if(i>=0){var l=u[r];i===n&&l===t||i===t&&l===n||(++c,f[r]=1)}else{a[r]=n;u[r]=t}}}function index(){var e=hashmap(1.4*n.length,hashIndex,equalIndex,Int32Array,-1,Int32Array),r=new Int32Array(n.length);for(var t=0,i=n.length;t<i;++t)r[t]=e.maybeSet(t,t);return r}function hashIndex(e){return hashPoint(n[e])}function equalIndex(e,r){return equalPoint(n[e],n[r])}o=a=u=null;var w=hashset(1.4*c,hashPoint,equalPoint),M;for(l=0,s=n.length;l<s;++l)f[M=i[l]]&&w.add(n[M]);return w};var cut=function(e){var n=join(e),r=e.coordinates,t=e.lines,i=e.rings,o,a,u;for(a=0,u=t.length;a<u;++a){var f=t[a],c=f[0],l=f[1];while(++c<l)if(n.has(r[c])){o={0:c,1:f[1]};f[1]=c;f=f.next=o}}for(a=0,u=i.length;a<u;++a){var s=i[a],h=s[0],g=h,y=s[1],v=n.has(r[h]);while(++g<y)if(n.has(r[g]))if(v){o={0:g,1:s[1]};s[1]=g;s=s.next=o}else{rotateArray(r,h,y,y-g);r[y]=r[h];v=true;g=h}}return e};function rotateArray(e,n,r,t){reverse(e,n,r);reverse(e,n,n+t);reverse(e,n+t,r)}function reverse(e,n,r){for(var t=n+(r---n>>1),i;n<t;++n,--r)i=e[n],e[n]=e[r],e[r]=i}var dedup=function(e){var n=e.coordinates,r=e.lines,t,i=e.rings,o,a=r.length+i.length,u,f;delete e.lines;delete e.rings;for(u=0,f=r.length;u<f;++u){t=r[u];while(t=t.next)++a}for(u=0,f=i.length;u<f;++u){o=i[u];while(o=o.next)++a}var c=hashmap(2*a*1.4,hashPoint,equalPoint),l=e.arcs=[];for(u=0,f=r.length;u<f;++u){t=r[u];do{dedupLine(t)}while(t=t.next)}for(u=0,f=i.length;u<f;++u){o=i[u];if(o.next)do{dedupLine(o)}while(o=o.next);else dedupRing(o)}function dedupLine(e){var r,t,i,o,a,u,f,s;if(i=c.get(r=n[e[0]]))for(f=0,s=i.length;f<s;++f){o=i[f];if(equalLine(o,e)){e[0]=o[0];e[1]=o[1];return}}if(a=c.get(t=n[e[1]]))for(f=0,s=a.length;f<s;++f){u=a[f];if(reverseEqualLine(u,e)){e[1]=u[0];e[0]=u[1];return}}i?i.push(e):c.set(r,[e]);a?a.push(e):c.set(t,[e]);l.push(e)}function dedupRing(e){var r,t,i,o,a;if(t=c.get(r=n[e[0]]))for(o=0,a=t.length;o<a;++o){i=t[o];if(equalRing(i,e)){e[0]=i[0];e[1]=i[1];return}if(reverseEqualRing(i,e)){e[0]=i[1];e[1]=i[0];return}}if(t=c.get(r=n[e[0]+findMinimumOffset(e)]))for(o=0,a=t.length;o<a;++o){i=t[o];if(equalRing(i,e)){e[0]=i[0];e[1]=i[1];return}if(reverseEqualRing(i,e)){e[0]=i[1];e[1]=i[0];return}}t?t.push(e):c.set(r,[e]);l.push(e)}function equalLine(e,r){var t=e[0],i=r[0],o=e[1],a=r[1];if(t-o!==i-a)return false;for(;t<=o;++t,++i)if(!equalPoint(n[t],n[i]))return false;return true}function reverseEqualLine(e,r){var t=e[0],i=r[0],o=e[1],a=r[1];if(t-o!==i-a)return false;for(;t<=o;++t,--a)if(!equalPoint(n[t],n[a]))return false;return true}function equalRing(e,r){var t=e[0],i=r[0],o=e[1],a=r[1],u=o-t;if(u!==a-i)return false;var f=findMinimumOffset(e),c=findMinimumOffset(r);for(var l=0;l<u;++l)if(!equalPoint(n[t+(l+f)%u],n[i+(l+c)%u]))return false;return true}function reverseEqualRing(e,r){var t=e[0],i=r[0],o=e[1],a=r[1],u=o-t;if(u!==a-i)return false;var f=findMinimumOffset(e),c=u-findMinimumOffset(r);for(var l=0;l<u;++l)if(!equalPoint(n[t+(l+f)%u],n[a-(l+c)%u]))return false;return true}function findMinimumOffset(e){var r=e[0],t=e[1],i=r,o=i,a=n[i];while(++i<t){var u=n[i];if(u[0]<a[0]||u[0]===a[0]&&u[1]<a[1]){o=i;a=u}}return o-r}return e};var delta=function(e){var n=-1,r=e.length;while(++n<r){var t=e[n],i=0,o=1,a=t.length,u=t[0],f=u[0],c=u[1],l,s;while(++i<a){u=t[i],l=u[0],s=u[1];l===f&&s===c||(t[o++]=[l-f,s-c],f=l,c=s)}1===o&&(t[o++]=[0,0]);t.length=o}return e};var extract=function(e){var n=-1,r=[],t=[],i=[];function extractGeometry(e){e&&o.hasOwnProperty(e.type)&&o[e.type](e)}var o={GeometryCollection:function(e){e.geometries.forEach(extractGeometry)},LineString:function(e){e.arcs=extractLine(e.arcs)},MultiLineString:function(e){e.arcs=e.arcs.map(extractLine)},Polygon:function(e){e.arcs=e.arcs.map(extractRing)},MultiPolygon:function(e){e.arcs=e.arcs.map(extractMultiRing)}};function extractLine(e){for(var t=0,o=e.length;t<o;++t)i[++n]=e[t];var a={0:n-o+1,1:n};r.push(a);return a}function extractRing(e){for(var r=0,o=e.length;r<o;++r)i[++n]=e[r];var a={0:n-o+1,1:n};t.push(a);return a}function extractMultiRing(e){return e.map(extractRing)}for(var a in e)extractGeometry(e[a]);return{type:"Topology",coordinates:i,lines:r,rings:t,objects:e}};var geometry=function(e){var n={},r;for(r in e)n[r]=geomifyObject(e[r]);return n};function geomifyObject(e){return null==e?{type:null}:("FeatureCollection"===e.type?geomifyFeatureCollection:"Feature"===e.type?geomifyFeature:geomifyGeometry)(e)}function geomifyFeatureCollection(e){var n={type:"GeometryCollection",geometries:e.features.map(geomifyFeature)};null!=e.bbox&&(n.bbox=e.bbox);return n}function geomifyFeature(e){var n=geomifyGeometry(e.geometry),r;null!=e.id&&(n.id=e.id);null!=e.bbox&&(n.bbox=e.bbox);for(r in e.properties){n.properties=e.properties;break}return n}function geomifyGeometry(e){if(null==e)return{type:null};var n="GeometryCollection"===e.type?{type:"GeometryCollection",geometries:e.geometries.map(geomifyGeometry)}:"Point"===e.type||"MultiPoint"===e.type?{type:e.type,coordinates:e.coordinates}:{type:e.type,arcs:e.coordinates};null!=e.bbox&&(n.bbox=e.bbox);return n}var prequantize=function(e,n,r){var t=n[0],i=n[1],o=n[2],a=n[3],u=o-t?(r-1)/(o-t):1,f=a-i?(r-1)/(a-i):1;function quantizePoint(e){return[Math.round((e[0]-t)*u),Math.round((e[1]-i)*f)]}function quantizePoints(e,n){var r=-1,o=0,a=e.length,c=new Array(a),l,s,h,g,y;while(++r<a){l=e[r];g=Math.round((l[0]-t)*u);y=Math.round((l[1]-i)*f);g===s&&y===h||(c[o++]=[s=g,h=y])}c.length=o;while(o<n)o=c.push([c[0][0],c[0][1]]);return c}function quantizeLine(e){return quantizePoints(e,2)}function quantizeRing(e){return quantizePoints(e,4)}function quantizePolygon(e){return e.map(quantizeRing)}function quantizeGeometry(e){null!=e&&c.hasOwnProperty(e.type)&&c[e.type](e)}var c={GeometryCollection:function(e){e.geometries.forEach(quantizeGeometry)},Point:function(e){e.coordinates=quantizePoint(e.coordinates)},MultiPoint:function(e){e.coordinates=e.coordinates.map(quantizePoint)},LineString:function(e){e.arcs=quantizeLine(e.arcs)},MultiLineString:function(e){e.arcs=e.arcs.map(quantizeLine)},Polygon:function(e){e.arcs=quantizePolygon(e.arcs)},MultiPolygon:function(e){e.arcs=e.arcs.map(quantizePolygon)}};for(var l in e)quantizeGeometry(e[l]);return{scale:[1/u,1/f],translate:[t,i]}};var topology=function(e,n){var r=bounds(e=geometry(e)),t=n>0&&r&&prequantize(e,r,n),i=dedup(cut(extract(e))),o=i.coordinates,a=hashmap(1.4*i.arcs.length,hashArc,equalArc);e=i.objects;i.bbox=r;i.arcs=i.arcs.map((function(e,n){a.set(e,n);return o.slice(e[0],e[1]+1)}));delete i.coordinates;o=null;function indexGeometry(e){e&&u.hasOwnProperty(e.type)&&u[e.type](e)}var u={GeometryCollection:function(e){e.geometries.forEach(indexGeometry)},LineString:function(e){e.arcs=indexArcs(e.arcs)},MultiLineString:function(e){e.arcs=e.arcs.map(indexArcs)},Polygon:function(e){e.arcs=e.arcs.map(indexArcs)},MultiPolygon:function(e){e.arcs=e.arcs.map(indexMultiArcs)}};function indexArcs(e){var n=[];do{var r=a.get(e);n.push(e[0]<e[1]?r:~r)}while(e=e.next);return n}function indexMultiArcs(e){return e.map(indexArcs)}for(var f in e)indexGeometry(e[f]);if(t){i.transform=t;i.arcs=delta(i.arcs)}return i};function hashArc(e){var n=e[0],r=e[1],t;r<n&&(t=n,n=r,r=t);return n+31*r}function equalArc(e,n){var r=e[0],t=e[1],i=n[0],o=n[1],a;t<r&&(a=r,r=t,t=a);o<i&&(a=i,i=o,o=a);return r===i&&t===o}e.topology=topology;Object.defineProperty(e,"__esModule",{value:true})}));const n=e.topology,r=e.__esModule;export default e;export{r as __esModule,n as topology};

